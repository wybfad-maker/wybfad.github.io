<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title></title>
  <style>
    #app {
      width: 100vw;
      height: 100vh;
      background: url(./wx.png);
      background-size: cover;
    }
  </style>
</head>

<body>
  <div id="app"><!--app-html--></div>
  <script>
    function getParamsFromUrl (url) {
      // 如果传入的是完整URL
      const urlObj = new URL(url)
      const params = new URLSearchParams(urlObj.search)
      const result = {}

      for (const [key, value] of params) {
        result[key] = value
      }

      return result
    }
    const appDiv = document.getElementById('app');
    appDiv.addEventListener('click', (e) => {
      console.log('click', e, window, window.location);
      const query = getParamsFromUrl(window.location.href)
      console.log('query', query)
      // 带认证的POST请求
      fetch('https://analytics.oceanengine.com/api/v2/conversion', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: {
          "event_type": "customer_effective",
          "context": {
            "ad": {
              "callback": params.clickid,//callback 这里需要填写的就是从启动参数里获取的 clickid
            }
          },
          "timestamp": new Date().getTime(),
        }
      })
      //   .then(response => response.json())
      //   .then(data => console.log(data));
      window.location.href = 'https://work.weixin.qq.com/ca/cawcde0cbbc2952ef8';
    });
  </script>
</body>

</html>